
$ ssh patch@patchbox.local # pw: blokaslabs

$ tail -f /var/log/syslog # view logs

## Setup instructions

$ patchbox [then choose wizard option]

- connect to Patchbox wifi, then ssh patch@patchbox.local
- follow set up, making sure to set up wifi (can also later doing it through the patchbox menu; this will disable the hotspot but that's okay)
- configure jack (via patchbox) to use -r44100 -p512 -n3
- next, update patchbox os

$ sudo apt-get update
$ sudo apt-get upgrade
$ sudo apt-get install sooperlooper
$ sudo apt-get install python3-pip
$ pip3 install pygame
$ pip3 install osc4py3
$ pip3 install numpy
$ sudo apt-get install libatlas-base-dev # to get numpy working
$ sudo apt-get install git curl libsdl2-mixer-2.0-0 libsdl2-image-2.0-0 libsdl2-2.0-0 # to get pygame working
$ sudo apt-get purge pulseaudio

- Enable I2C and SPI, and install CircuitPython libraries in Python3 here: https://learn.adafruit.com/circuitpython-on-raspberrypi-linux/installing-circuitpython-on-raspberry-pi
- run "blinkatest.py" to confirm it's working

$ sudo pip3 install adafruit-circuitpython-neotrellis

$ sudo systemctl stop pisound-ctl.service
$ sudo systemctl stop pisound-btn
$ sudo systemctl stop bluealsa
$ sudo systemctl stop bluetooth
$ sudo systemctl mask pisound-ctl.service # nb 'mask' is patchbox-specific; acts like 'disable'
$ sudo systemctl mask pisound-btn
$ sudo systemctl mask bluealsa
$ sudo systemctl mask bluetooth
$ sudo cp static/looper_patchbox.service /etc/systemd/system/looper.service
$ sudo systemctl enable looper.service

## To start looper manually:

sooperlooper -p 9951 -l 1 -c 2 -t 20 &
jack_connect system:capture_1 sooperlooper:common_in_1 || echo "error connecting audio (1)"
jack_connect sooperlooper:common_out_1 system:playback_1 || echo "error connecting audio (2)"
jack_connect sooperlooper:common_out_2 system:playback_2 || echo "error connecting audio (3)"

python3 loop-baby/looper.py -v

## To install module

$ patchbox module install https://github.com/mobeets/loop-baby # downloads to /usr/local/patchbox-modules/imported/
$ patchbox module activate loop-baby
$ patchbox module launch loop-baby

## To do

- make patchbox module run loop-baby only within module folder (not ~/loop-baby)
	- this will involve fixing path to looper.py in launch
	- to update code, go to /usr/local/patchbox-modules/imported/ and run 'sudo git pull'
- also, make looper.py write to log files, for better debugging
- another issue is it says no numpy? (as if python2 and not python3 is being called?)
	- it might be running as root user

## Usage notes

- 2021-01-18: no crispy sound issues! maybe it was the disabling of the other systemctl processes?
- 2021-01-19: finally got audio monitoring turned off, using alsamixer, by muting the "Mic" playback meter (not the capture one) for my usb interface; still no crispy sound issues, though maybe a pop or two
- 2021-01-21: permanently disabled unneeded systemctl processes using 'systemctl mask'
